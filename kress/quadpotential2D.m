function R=quadpotential2D(n,ti,tj)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \int_(0)^(2pi)ln(4sin^2((t-\tau)/2))f(\tau)d\tau=\sum_(j=0)^(2n-1) %
% R_j^(n)(t)f(t_j)                                                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% R_j^(n)(t)=-2pi/n\sum_(m=1)^(n-1)cos(m(t-t_j))/m-pi/(n^2) %
% cos(n(t-t_j))                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
s=0;
for m=1:n-1
    s=s+(1/m)*cos(m*(ti-tj));
end
R=-(2*pi/n)*s-pi/(n*n)*cos(n*(ti-tj));
